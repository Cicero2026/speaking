<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>æ¼”è¬›å­¸ æœŸæœ«è€ƒé¡Œåº«å°æ¸¬é©—ï¼šè›‹ç³• vs å†°å¡Š</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    /* ===== åŸºæœ¬ç‰ˆé¢ ===== */
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: #f8fafc;
      color: #111827;
      display: flex;
      justify-content: center;
    }
    .container {
      max-width: 900px;
      width: 100%;
      padding: 20px 16px 40px;
    }
    h1 {
      font-size: 1.8rem;
      margin-bottom: 0.3rem;
      text-align: center;
    }
    .subtitle {
      text-align: center;
      margin-bottom: 1rem;
      color: #4b5563;
    }
    .tagline {
      text-align: center;
      margin-bottom: 1.2rem;
      font-weight: 500;
    }

    /* ===== å¡ç‰‡ ===== */
    .card {
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(15, 23, 42, 0.08);
      padding: 18px 16px 20px;
      margin-bottom: 16px;
    }

    /* ===== æ§åˆ¶å€ ===== */
    .control-row {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
      margin-bottom: 10px;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 8px 16px;
      font-size: 0.95rem;
      cursor: pointer;
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.1s ease;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    button:active {
      transform: translateY(1px);
      box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1) inset;
    }

    .btn-primary {
      background: #2563eb;
      color: white;
      box-shadow: 0 4px 10px rgba(37, 99, 235, 0.35);
    }
    .btn-primary:hover {
      background: #1d4ed8;
    }

    .btn-secondary {
      background: #e5e7eb;
      color: #111827;
    }
    .btn-secondary:hover {
      background: #d1d5db;
    }

    .btn-muted {
      background: #f3f4f6;
      color: #4b5563;
    }

    .btn-option {
      width: 100%;
      text-align: left;
      justify-content: flex-start;
      margin-bottom: 8px;
      background: #f9fafb;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
    }
    .btn-option:hover {
      background: #eef2ff;
      border-color: #c7d2fe;
    }
    .btn-option.correct {
      background: #dcfce7;
      border-color: #16a34a;
    }
    .btn-option.incorrect {
      background: #fee2e2;
      border-color: #ef4444;
    }
    .btn-option.disabled {
      opacity: 0.7;
      pointer-events: none;
    }

    /* ===== é¡Œç›®èˆ‡é€²åº¦ ===== */
    .status-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      font-size: 0.9rem;
      color: #6b7280;
    }
    .progress-dots {
      display: flex;
      gap: 6px;
    }
    .dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: #e5e7eb;
    }
    .dot.active {
      background: #6366f1;
    }
    .dot.done {
      background: #22c55e;
    }

    .question-text {
      font-size: 1.05rem;
      font-weight: 600;
      margin-bottom: 14px;
    }

    /* ===== å›é¥‹è¨Šæ¯ ===== */
    .feedback {
      margin-top: 8px;
      min-height: 24px;
      font-size: 0.96rem;
      font-weight: 500;
    }
    .feedback.correct {
      color: #16a34a;
    }
    .feedback.incorrect {
      color: #b91c1c;
    }

    /* ===== è›‹ç³• & å†°å¡Šåˆ— ===== */
    .score-card {
      display: flex;
      flex-direction: column;
      gap: 6px;
      font-size: 0.95rem;
    }
    .score-row {
      display: flex;
      align-items: center;
      gap: 8px;
      min-height: 24px;
      flex-wrap: wrap;
    }
    .score-label {
      min-width: 90px;
      font-weight: 600;
    }
    .score-icons {
      display: flex;
      flex-wrap: wrap;
      gap: 2px;
    }

    /* ===== çµæœå€ ===== */
    .result {
      font-size: 1rem;
      font-weight: 600;
      text-align: center;
      margin-top: 4px;
    }
    .result.good {
      color: #16a34a;
    }
    .result.bad {
      color: #b91c1c;
    }
    .result.tie {
      color: #92400e;
    }

    /* ===== RWD ===== */
    @media (min-width: 640px) {
      .card {
        padding: 20px 20px 22px;
      }
      h1 {
        font-size: 2rem;
      }
    }
  </style>
</head>
<body>
  <!-- è²éŸ³ï¼šè«‹ä¾éœ€è¦æ›¿æ›æˆè‡ªå·±çš„æª”æ¡ˆ -->
  <!-- èƒŒæ™¯éŸ³æ¨‚ï¼ˆè¼•å¿«ï¼‰ -->
  <audio id="bgMusic" loop>
    <source src="BG.MP3" type="audio/mpeg" />
  </audio>

  <!-- ç­”å°ï¼šé¼“æŒ -->
  <audio id="applauseSound">
    <source src="clap.MP3" type="audio/mpeg" />
  </audio>

  <!-- ç­”éŒ¯ï¼å†°å¡Šè¼ƒå¤šï¼šå–®ä¸€ä¸‹é¼“è² -->
  <audio id="drumSound">
    <source src="drum.MP3" type="audio/mpeg" />
  </audio>

  <!-- çµæœè›‹ç³•è¼ƒå¤šï¼šæ­¡å‘¼ -->
  <audio id="cheerSound">
    <source src="WOW.MP3" type="audio/mpeg" />
  </audio>

  <div class="container">
    <h1>æ¼”è¬›å­¸ æœŸæœ«è€ƒé¡Œåº«å°æ¸¬é©—</h1>
    <div class="subtitle">èª²ç¨‹ï¼šæ¼”è¬›å­¸ï½œæ¯å›åˆ 5 é¡Œï½œç­”å° ğŸ‚ è›‹ç³•ã€ç­”éŒ¯ ğŸ§Š å†°å¡Š</div>
    <div class="tagline">æœ€å¾Œå¦‚æœè›‹ç³•æ¯”å†°å¡Šå¤šï¼Œæœƒæœ‰å…¨å ´æ­¡å‘¼ï¼›å¦‚æœå†°å¡Šæ¯”è¼ƒå¤šï¼Œå°±åªå‰©ä¸‹å­¤ç¨çš„é¼“è²â‹¯</div>

    <div class="card">
      <div class="control-row">
        <button id="startBtn" class="btn-primary">
          â–¶ï¸ é–‹å§‹æ¸¬é©—
        </button>
        <button id="nextBtn" class="btn-secondary" style="display:none;">
          â¡ï¸ ä¸‹ä¸€é¡Œ
        </button>
        <button id="resetBtn" class="btn-secondary" style="display:none;">
          ğŸ” é‡æ–°æ¸¬é©—ï¼ˆæŠ½æ–° 5 é¡Œï¼‰
        </button>
        <button id="musicBtn" class="btn-muted">
          ğŸµ Music: OFF
        </button>
      </div>

      <div class="status-row">
        <div id="progressText">è«‹å…ˆæŒ‰ã€Œé–‹å§‹æ¸¬é©—ã€</div>
        <div class="progress-dots" id="progressDots"></div>
      </div>

      <div id="questionArea" style="display:none;">
        <div class="question-text" id="questionText"></div>
        <div id="optionsContainer"></div>
        <div id="feedback" class="feedback"></div>
      </div>

      <div id="resultArea" style="display:none; margin-top:10px;">
        <div id="resultText" class="result"></div>
      </div>
    </div>

    <div class="card">
      <div class="score-card">
        <div class="score-row">
          <div class="score-label">ğŸ‚ Cakesï¼š</div>
          <div id="cakeRow" class="score-icons"></div>
        </div>
        <div class="score-row">
          <div class="score-label">ğŸ§Š Ice blocksï¼š</div>
          <div id="iceRow" class="score-icons"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- é¡Œåº« -->
  <script src="questions.js"></script>

  <!-- éŠæˆ²é‚è¼¯ -->
  <script>
    const TOTAL_PER_ROUND = 5;

    const bgMusic = document.getElementById("bgMusic");
    const applauseSound = document.getElementById("applauseSound");
    const drumSound = document.getElementById("drumSound");
    const cheerSound = document.getElementById("cheerSound");

    const startBtn = document.getElementById("startBtn");
    const nextBtn  = document.getElementById("nextBtn");
    const resetBtn = document.getElementById("resetBtn");
    const musicBtn = document.getElementById("musicBtn");

    const progressText  = document.getElementById("progressText");
    const progressDots  = document.getElementById("progressDots");
    const questionArea  = document.getElementById("questionArea");
    const questionText  = document.getElementById("questionText");
    const optionsContainer = document.getElementById("optionsContainer");
    const feedbackEl    = document.getElementById("feedback");

    const resultArea = document.getElementById("resultArea");
    const resultText = document.getElementById("resultText");

    const cakeRow = document.getElementById("cakeRow");
    const iceRow  = document.getElementById("iceRow");

    let musicOn = false;
    let currentQuestions = [];
    let currentIndex = 0;
    let cakeCount = 0;
    let iceCount = 0;
    let answered = false;

    function playSound(audio) {
      if (!audio) return;
      audio.currentTime = 0;
      audio.play().catch(() => {});
    }

    function toggleMusic() {
      musicOn = !musicOn;
      if (musicOn) {
        bgMusic.play().catch(() => {});
        musicBtn.textContent = "ğŸµ Music: ON";
      } else {
        bgMusic.pause();
        musicBtn.textContent = "ğŸµ Music: OFF";
      }
    }

    musicBtn.addEventListener("click", toggleMusic);

    function shuffleArray(arr) {
      const a = arr.slice();
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function pickRandomQuestions() {
      const shuffled = shuffleArray(QUESTIONS);
      return shuffled.slice(0, TOTAL_PER_ROUND);
    }

    function resetScoreBoard() {
      cakeCount = 0;
      iceCount = 0;
      cakeRow.innerHTML = "";
      iceRow.innerHTML = "";
    }

    function addCake() {
      cakeCount++;
      const span = document.createElement("span");
      span.textContent = "ğŸ‚";
      cakeRow.appendChild(span);
    }

    function addIce() {
      iceCount++;
      const span = document.createElement("span");
      span.textContent = "ğŸ§Š";
      iceRow.appendChild(span);
    }

    function updateProgress() {
      progressText.textContent = `Question ${currentIndex + 1} / ${TOTAL_PER_ROUND}`;
      progressDots.innerHTML = "";
      for (let i = 0; i < TOTAL_PER_ROUND; i++) {
        const dot = document.createElement("div");
        dot.classList.add("dot");
        if (i < currentIndex) {
          dot.classList.add("done");
        } else if (i === currentIndex) {
          dot.classList.add("active");
        }
        progressDots.appendChild(dot);
      }
    }

    function renderQuestion() {
      feedbackEl.textContent = "";
      feedbackEl.className = "feedback";
      resultArea.style.display = "none";
      resultText.textContent = "";
      nextBtn.style.display = "none";

      if (currentIndex >= TOTAL_PER_ROUND) {
        showResult();
        return;
      }

      const q = currentQuestions[currentIndex];
      questionArea.style.display = "block";
      questionText.textContent = q.question;

      optionsContainer.innerHTML = "";
      const letters = ["A", "B", "C", "D"];

      q.options.forEach((optText, idx) => {
        const btn = document.createElement("button");
        btn.className = "btn-option";
        btn.innerHTML = `<strong>${letters[idx]})</strong>&nbsp;&nbsp;${optText}`;
        btn.dataset.letter = letters[idx];

        btn.addEventListener("click", () => handleAnswer(btn, q));
        optionsContainer.appendChild(btn);
      });

      answered = false;
      updateProgress();
    }

    function disableOptions(markCorrectLetter, clickedLetter) {
      const buttons = optionsContainer.querySelectorAll("button");
      buttons.forEach(btn => {
        const letter = btn.dataset.letter;
        btn.classList.add("disabled");
        if (letter === markCorrectLetter) {
          btn.classList.add("correct");
        }
        if (clickedLetter && letter === clickedLetter && clickedLetter !== markCorrectLetter) {
          btn.classList.add("incorrect");
        }
      });
    }

    function handleAnswer(button, q) {
      if (answered) return;
      answered = true;

      const chosen = button.dataset.letter;
      const correctLetter = q.correct;

      disableOptions(correctLetter, chosen);

      if (chosen === correctLetter) {
        feedbackEl.textContent = "âœ”ï¸ Correct! Good job!";
        feedbackEl.classList.add("correct");
        addCake();
        playSound(applauseSound);
      } else {
        feedbackEl.textContent = `âœ–ï¸ Not quite. The correct answer is ${correctLetter}.`;
        feedbackEl.classList.add("incorrect");
        addIce();
        playSound(drumSound);
      }

      if (currentIndex < TOTAL_PER_ROUND - 1) {
        nextBtn.style.display = "inline-flex";
      } else {
        nextBtn.style.display = "inline-flex";
        nextBtn.textContent = "âœ… çœ‹çµæœ";
      }
    }

    function showResult() {
      questionArea.style.display = "none";
      resultArea.style.display = "block";
      resetBtn.style.display = "inline-flex";
      startBtn.style.display = "none";
      nextBtn.style.display = "none";
      nextBtn.textContent = "â¡ï¸ ä¸‹ä¸€é¡Œ";

      if (cakeCount > iceCount) {
        resultText.textContent =
          `ğŸ‰ å¤ªæ£’äº†ï¼ä½ é€™å›åˆçš„è›‹ç³•ï¼ˆ${cakeCount}ï¼‰æ¯”å†°å¡Šï¼ˆ${iceCount}ï¼‰å¤šï¼ŒæœŸæœ«è€ƒç©©ç©©çš„ï¼`;
        resultText.className = "result good";
        playSound(cheerSound);
      } else if (iceCount > cakeCount) {
        resultText.textContent =
          `ğŸ§Š é€™æ¬¡å†°å¡Šï¼ˆ${iceCount}ï¼‰æ¯”è›‹ç³•ï¼ˆ${cakeCount}ï¼‰å¤šï¼Œå†ç©ä¸€å›åˆå°±æœƒæ›´ç†Ÿäº†ï¼`;
        resultText.className = "result bad";
        playSound(drumSound);
      } else {
        resultText.textContent =
          `ğŸ¤ å¹³æ‰‹ï¼è›‹ç³• ${cakeCount} é¡†ï¼Œå†°å¡Š ${iceCount} å€‹ã€‚å†ä¾†ä¸€å›åˆæ‹‰é–‹å·®è·ï¼`;
        resultText.className = "result tie";
      }
    }

    function startQuiz() {
      currentQuestions = pickRandomQuestions();
      currentIndex = 0;
      resetScoreBoard();
      resultArea.style.display = "none";
      resultText.textContent = "";

      questionArea.style.display = "block";
      progressText.textContent = "Question 1 / " + TOTAL_PER_ROUND;

      startBtn.style.display = "none";
      resetBtn.style.display = "inline-flex";
      nextBtn.style.display = "none";
      nextBtn.textContent = "â¡ï¸ ä¸‹ä¸€é¡Œ";

      if (!musicOn) {
        // å…ˆä¸å¼·è¿«é–‹ï¼Œä¿ç•™åŸæœ¬ OFF ç‹€æ…‹
      } else {
        bgMusic.play().catch(() => {});
      }

      renderQuestion();
    }

    function nextQuestion() {
      if (currentIndex >= TOTAL_PER_ROUND) return;
      currentIndex++;
      renderQuestion();
    }

    function resetQuiz() {
      currentQuestions = pickRandomQuestions();
      currentIndex = 0;
      resetScoreBoard();
      resultArea.style.display = "none";
      resultText.textContent = "";
      nextBtn.style.display = "none";
      nextBtn.textContent = "â¡ï¸ ä¸‹ä¸€é¡Œ";
      startBtn.style.display = "none"; // ä¸€æ—¦é€²å…¥éŠæˆ²ï¼Œå°±ä»¥ reset ç‚ºä¸»
      renderQuestion();
    }

    startBtn.addEventListener("click", startQuiz);
    nextBtn.addEventListener("click", () => {
      if (currentIndex >= TOTAL_PER_ROUND - 1) {
        // å·²ç¶“æ˜¯æœ€å¾Œä¸€é¡Œï¼Œé¡¯ç¤ºçµæœ
        currentIndex = TOTAL_PER_ROUND;
        showResult();
      } else {
        nextQuestion();
      }
    });
    resetBtn.addEventListener("click", resetQuiz);

    // åˆå§‹ç‹€æ…‹ï¼šé¡¯ç¤º 5 å€‹ç°è‰²é€²åº¦é»ï¼Œè®“ç•«é¢ä¸è¦å¤ªç©º
    (function initDots() {
      progressDots.innerHTML = "";
      for (let i = 0; i < TOTAL_PER_ROUND; i++) {
        const dot = document.createElement("div");
        dot.classList.add("dot");
        progressDots.appendChild(dot);
      }
    })();
  </script>
</body>
</html>
